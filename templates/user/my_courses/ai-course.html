{% extends 'user/base.html' %}
{% block title %}{{ course_name }}{% endblock %}
{% block extra_css %}
    <link rel="stylesheet"
          href="{{ url_for("static", filename = 'css/user/my_courses/ai-course.css') }}">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/atom-one-dark.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
{% endblock %}
{% block content %}
    <!-- AI Course Page -->
    <div class="ai-course-wrapper">
        <!--Ai course top bar-->
        <div class="ai-course-top-bar">
            <p class="course-name">{{ course_name }}</p>
        </div>
        <!--End Ai course top bar-->
        <!-- AI Course Content -->
        <!-- This is the main container for the AI course content and chat -->
        <div class="ai-course-cont">
            <div class="ai-course-cont-wrapper">
                <!-- This is the top bar of the AI course content, which includes the search box and the course name and read aloud button -->
                <div class="ai-course-cont-top-bar">
                    <!-- Search box and course name with read aloud button -->
                    <!-- The search box allows users to search for keywords in the course content -->
                    <div class="search-keywords-wrapper">
                        <input type="text" id="searchBox" class="searchBox" placeholder="Search..." />
                        <button class="search-btn" onclick="show_search_box()">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                 id="Outline"
                                 viewBox="0 0 24 24"
                                 width="512"
                                 height="512">
                                <path d="M23.707,22.293l-5.969-5.969a10.016,10.016,0,1,0-1.414,1.414l5.969,5.969a1,1,0,0,0,1.414-1.414ZM10,18a8,8,0,1,1,8-8A8.009,8.009,0,0,1,10,18Z" />
                            </svg>
                        </button>
                    </div>
                    <!--End of search box-->
                    <!-- Course name and read aloud button -->
                    <!-- The course name is displayed here, and the read aloud button allows users to listen to the course content -->
                    <div class="coursename-and-read-aloud-wrapper">
                        <p class="coursename">{{ course_name }}</p>
                        <button class="speak-btn">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                 id="Layer_1"
                                 data-name="Layer 1"
                                 viewBox="0 0 24 24"
                                 width="512"
                                 height="512">
                                <path d="m19,8v8c0,.553-.447,1-1,1s-1-.447-1-1v-8c0-.553.447-1,1-1s1,.447,1,1ZM14,0c-.553,0-1,.447-1,1v22c0,.553.447,1,1,1s1-.447,1-1V1c0-.553-.447-1-1-1Zm8,4c-.553,0-1,.447-1,1v14c0,.553.447,1,1,1s1-.447,1-1V5c0-.553-.447-1-1-1Zm-12,0c-.553,0-1,.447-1,1v14c0,.553.447,1,1,1s1-.447,1-1V5c0-.553-.447-1-1-1Zm-4,3c-.553,0-1,.447-1,1v8c0,.553.447,1,1,1s1-.447,1-1v-8c0-.553-.447-1-1-1Zm-4,2c-.553,0-1,.447-1,1v4c0,.553.447,1,1,1s1-.447,1-1v-4c0-.553-.447-1-1-1Z" />
                            </svg>
                        </button>
                    </div>
                    <!--End of course name and read aloud button-->
                </div>
                <!--End of ai course content top bar-->
                <!-- This is the main content and chat wrapper, which contains the course content and the chat interface -->
                <!-- The content is displayed in the content div, and the chat interface is in the ai-assistance-wrapper -->
                <div class="content-and-chat-wrapper">
                    <div class="content-wrapper">
                        <div class="content">{{ content | safe }}</div>
                        <form action="{{ url_for("my_courses.ai_course_complete") }}"
                              method="post"
                              class="done-form">
                            <input type="hidden" name="completed" value="completed" />
                            <button class="done-btn" type="submit">Done</button>
                        </form>
                    </div>
                    <div class="ai-assistance-wrapper">
                        <div class="chat-content"></div>
                        <div class="chat-input-wrapper">
                            <input autocomplete="off"
                                   type="text"
                                   name="user-input"
                                   id="user-input"
                                   placeholder="Have a Problem. Ask from here" />
                            <button class="send-btn">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     id="Outline"
                                     viewBox="0 0 24 24"
                                     width="512"
                                     height="512">
                                    <path d="M23.119.882a2.966,2.966,0,0,0-2.8-.8l-16,3.37a4.995,4.995,0,0,0-2.853,8.481L3.184,13.65a1,1,0,0,1,.293.708v3.168a2.965,2.965,0,0,0,.3,1.285l-.008.007.026.026A3,3,0,0,0,5.157,20.2l.026.026.007-.008a2.965,2.965,0,0,0,1.285.3H9.643a1,1,0,0,1,.707.292l1.717,1.717A4.963,4.963,0,0,0,15.587,24a5.049,5.049,0,0,0,1.605-.264,4.933,4.933,0,0,0,3.344-3.986L23.911,3.715A2.975,2.975,0,0,0,23.119.882ZM4.6,12.238,2.881,10.521a2.94,2.94,0,0,1-.722-3.074,2.978,2.978,0,0,1,2.5-2.026L20.5,2.086,5.475,17.113V14.358A2.978,2.978,0,0,0,4.6,12.238Zm13.971,7.17a3,3,0,0,1-5.089,1.712L11.762,19.4a2.978,2.978,0,0,0-2.119-.878H6.888L21.915,3.5Z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <!--End of content and chat wrapper-->
            </div>
        </div>
    </div>
    <!-- End AI Course Page -->
{% endblock %}
{% block extra_js %}
    <script>let chat_url = '{{ url_for("ai_chat.ai_course_chat")  }}';</script>
    <script src="{{  url_for('static', filename='js/user/my_courses/ai-course.js') }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/go.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js"></script>
    <script>
  const searchBox = document.getElementById("searchBox");
  const contentEl = document.querySelector(".content");
  const markInstance = new Mark(contentEl);

  searchBox.addEventListener("input", () => {
    const keyword = searchBox.value.trim();
    markInstance.unmark({
      done: () => {
        if (keyword !== "") {
          markInstance.mark(keyword);
        }
      },
    });
  });
    </script>
{% endblock %}
